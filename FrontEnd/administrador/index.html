<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Panel de administración</title>
        <link rel="stylesheet" href="./css/styles-admin.css">
        <link rel="icon" type="image/png" href="./img-admin/rueda.png">
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&family=Vend+Sans:ital,wght@0,300..700;1,300..700&display=swap" rel="stylesheet">
    </head>
    
    <body>
        <header>
            <nav>
                <ul>
                    <li><a href="index.html">Ver</a></li>
                    <li><a href="consultar.html">Consultar id</a></li>
                    <li><a href="crear.html">Crear</a></li>
                    <li><a href="modificar.html">Modificar</a></li>
                    <li><a href="eliminar.html">Eliminar</a></li>  
                </ul>
            </nav>
        </header>
        
            <main>
                <div class="logo-titulo">
                    <img src="./img-admin/rueda.png" alt="Imagen de rueda">
                    <h1>Panel administración | Entre líneas</h1>
                </div>
                <section id="contenedor-productos"></section>
            </main>

            
            <script>
                
            let contenedorProductos = document.getElementById("contenedor-productos");
            let url = "http://localhost:3000";

            async function obtenerProductos() {
                try {
                    let response = await fetch(`${url}/api/products`);

                    console.log(`Solicitud fetch GET a ${url}/api/products`);

                    let data = await response.json();

                    console.log(data);
                    let productos = data.payload;
                    console.log(productos);

                    mostrarProductos(productos);

                } catch (error) {
                    console.error("Error obteniendo productos: ", error);
                }
            }


            function mostrarProductos(array) {
                let htmlProductos = "";

                array.forEach(prod => {
                    htmlProductos += `
                        <div class="card-producto">
                            <img class="producto-img" src="${prod.ruta_img}" alt="${prod.titulo}">
                            <h3>${prod.titulo}</h3>
                            <p>Id: ${prod.id}</p>
                            <p>$${prod.precio}</p>
                        </div>
                    `;
                });

                contenedorProductos.innerHTML = htmlProductos;
            }

            function init() {
                obtenerProductos();
            }

            init();
        </script>
    
    </body>
</html>